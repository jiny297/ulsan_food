<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>회원가입 - 울산의 숨은 맛집</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #E6F4F1 0%,#CFE8E2 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .signup-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 50px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 500px;
            padding: 50px 40px;
        }

        .logo-section {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo-section i {
            font-size: 3.5rem;
            color: #4DA6A6;
            margin-bottom: 15px;
        }

        .logo-section h1 {
            font-size: 1.8rem;
            color: #333;
            margin-bottom: 10px;
        }

        .logo-section p {
            color: #666;
            font-size: 0.95rem;
        }

        .benefit-box {
            background: linear-gradient(135deg, #4DA6A6 0%, #3C8F8F 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
        }

        .benefit-box i {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .benefit-box h3 {
            margin-bottom: 5px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
            font-size: 0.95rem;
        }

        .required {
            color: #ff4444;
        }

        .input-wrapper {
            position: relative;
        }

        .input-wrapper i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }

        .form-group input {
            width: 100%;
            padding: 12px 12px 12px 45px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #4DA6A6;
        }

        .error-message {
            color: #ff4444;
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .success-message {
            color: #51cf66;
            font-size: 0.85rem;
            margin-top: 5px;
            display: none;
        }

        .success-message.show {
            display: block;
        }

        .password-strength {
            margin-top: 8px;
            height: 4px;
            background: #e0e0e0;
            border-radius: 2px;
            overflow: hidden;
            display: none;
        }

        .password-strength.show {
            display: block;
        }

        .password-strength-bar {
            height: 100%;
            width: 0%;
            transition: all 0.3s;
        }

        .strength-weak { background: #ff4444; width: 33%; }
        .strength-medium { background: #ffa500; width: 66%; }
        .strength-strong { background: #51cf66; width: 100%; }

        .btn-signup {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #4DA6A6 0%, #3C8F8F 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            margin-top: 10px;
        }

        .btn-signup:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-signup:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .login-link {
            text-align: center;
            color: #666;
            font-size: 0.95rem;
            margin-top: 20px;
        }

        .login-link a {
            color: #4DA6A6;
            font-weight: bold;
            text-decoration: none;
        }

        .login-link a:hover {
            text-decoration: underline;
        }

        
        .terms {
            margin: 20px 0;
            padding: 15px;
            background: #c9dfda; /*이용약관 배경 색*/
            border-radius: 8px;
            font-size: 0.85rem;
        }

        .terms label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            margin-bottom: 8px;
        }

        .terms input[type="checkbox"] {
            cursor: pointer;
        }

        /* 아코디언 내용 스타일 */
        .details {
            display: none;
            margin: 5px 0 10px 24px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            background-color: #fff;
            max-height: 150px;
            overflow-y: auto;
            line-height: 1.4;
        }

        .details.open {
            display: block;
        }

        .view-link {
            color: #4DA6A6;
            text-decoration: underline;
            cursor: pointer;
            font-size: 0.8rem;
            margin-left: 4px;
        }

        .view-link:hover {
            text-decoration: none;
        }

        @media (max-width: 480px) {
            .signup-container {
                padding: 40px 30px;
            }

            .logo-section h1 {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="signup-container">
        <div class="logo-section">
            <i class="fas fa-map-marker-alt"></i>
            <h1>회원가입</h1>
            <p>울산의 숨은 맛집과 함께하세요</p>
        </div>

        <div class="benefit-box">
            <i class="fas fa-gift"></i>
            <h3>🎁 가입 축하 혜택</h3>
            <p>지금 가입하고 <strong>3,000 포인트</strong> 받으세요!</p>
        </div>

        <form id="signupForm">
            <div class="form-group">
                <label for="userName">이름 <span class="required">*</span></label>
                <div class="input-wrapper">
                    <i class="fas fa-user"></i>
                    <input type="text" id="userName" placeholder="실명을 입력하세요" required>
                </div>
                <div class="error-message" id="nameError"></div>
            </div>

            <div class="form-group">
                <label for="userEmail">이메일 <span class="required">*</span></label>
                <div class="input-wrapper">
                    <i class="fas fa-envelope"></i>
                    <input type="email" id="userEmail" placeholder="example@email.com" required>
                </div>
                <div class="error-message" id="emailError"></div>
            </div>

            <div class="form-group">
                <label for="userPw">비밀번호 <span class="required">*</span></label>
                <div class="input-wrapper">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="userPw" placeholder="8자 이상 입력하세요" required>
                </div>
                <div class="password-strength" id="pwStrength">
                    <div class="password-strength-bar" id="pwStrengthBar"></div>
                </div>
                <div class="error-message" id="pwError"></div>
            </div>

            <div class="form-group">
                <label for="userPwConfirm">비밀번호 확인 <span class="required">*</span></label>
                <div class="input-wrapper">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="userPwConfirm" placeholder="비밀번호 재입력" required>
                </div>
                <div class="error-message" id="pwConfirmError"></div>
                <div class="success-message" id="pwConfirmSuccess">비밀번호가 일치합니다.</div>
            </div>

            <div class="terms">
                <label>
                    <input type="checkbox" id="agreeAll">
                    <strong>전체 동의</strong>
                </label>

                <label>
                    <input type="checkbox" class="agree-item" required>
                    [필수] 이용약관 동의
                    <span class="view-link" onclick="toggleDetails('terms1')">자세히 보기</span>
                </label>
                <div id="terms1" class="details">
                    1. 목적<br>
                    이 약관은 회사와 이용자 간의 권리·의무 및 책임사항, 서비스 이용조건 등을 정함을 목적으로 합니다.<br><br>

                    2. 약관의 효력 및 변경<br>
                    ① 이 약관은 회원이 동의함으로써 효력이 발생합니다.<br>
                    ② 회사는 관련 법령을 위배하지 않는 범위 내에서 이 약관을 개정할 수 있으며, 변경 시 사전 공지를 통해 회원에게 알립니다.<br>
                    ③ 회원이 변경된 약관에 동의하지 않을 경우, 회원 탈퇴를 통해 계약을 해지할 수 있습니다.<br><br>

                    3. 이용계약의 체결<br>
                    ① 이용계약은 회원이 약관에 동의하고, 회사가 정한 절차에 따라 회원가입을 승인함으로써 성립합니다.<br>
                    ② 회사는 다음 각 호에 해당하는 신청에 대하여 승인을 거부할 수 있습니다.<br>
                      - 타인의 명의로 신청한 경우<br>
                      - 허위 정보를 기재한 경우<br>
                      - 사회의 안녕질서 또는 미풍양속을 저해할 우려가 있는 경우<br><br>

                    4. 회원정보의 변경<br>
                    회원은 가입 시 기재한 정보가 변경된 경우 즉시 수정해야 하며, 변경하지 않아 발생한 불이익에 대하여 회사는 책임을 지지 않습니다.<br><br>

                    5. 회원의 의무<br>
                    ① 회원은 다음 행위를 하여서는 안 됩니다.<br>
                      - 타인의 정보 도용<br>
                      - 서비스의 정상적인 운영을 방해하는 행위<br>
                      - 법령 및 공서양속에 위반되는 행위<br>
                      - 광고성 정보의 무단 전송<br>
                    ② 회원은 이 약관 및 회사의 공지사항, 운영정책을 준수해야 합니다.<br><br>

                    6. 회사의 의무<br>
                    ① 회사는 안정적인 서비스 제공을 위하여 최선을 다합니다.<br>
                    ② 회사는 회원의 개인정보를 관련 법령에 따라 보호하며, 회원의 동의 없이 제3자에게 제공하지 않습니다.<br>
                    ③ 서비스 중단, 장애 등의 사유가 발생한 경우 회사는 지체 없이 이를 공지합니다.<br><br>

                    7. 서비스의 제공 및 변경<br>
                    ① 회사는 회원에게 다음 서비스를 제공합니다.<br>
                      - 콘텐츠 제공 서비스<br>
                      - 게시판 및 커뮤니티 운영<br>
                      - 포인트 및 쿠폰 제공 서비스<br>
                    ② 회사는 서비스 운영상 또는 기술상의 필요에 따라 서비스의 일부 또는 전부를 변경할 수 있습니다.<br>
                    ③ 서비스의 변경 또는 중단 시 회사는 사전 공지합니다.<br><br>

                    8. 포인트 및 쿠폰<br>
                    ① 회사는 회원에게 포인트 또는 쿠폰을 부여할 수 있으며, 그 사용방법·유효기간·소멸조건 등은 별도 정책에 따릅니다.<br>
                    ② 포인트 및 쿠폰은 현금으로 환급되지 않으며, 서비스 내에서만 사용할 수 있습니다.<br>
                    ③ 회원이 부정한 방법으로 포인트를 적립하거나 사용한 경우 회사는 이를 취소할 수 있습니다.<br><br>

                    9. 유료서비스 및 결제<br>
                    ① 회사는 일부 서비스에 대하여 유료로 제공할 수 있습니다.<br>
                    ② 유료서비스의 이용, 결제, 환불 등에 관한 사항은 관련 법령 및 회사의 별도 정책에 따릅니다.<br>
                    ③ 회원이 결제수단을 부정 사용한 경우 회사는 해당 결제를 취소하고 법적 조치를 취할 수 있습니다.<br><br>

                    10. 게시물의 관리 및 저작권<br>
                    ① 회원이 서비스 내에 게시한 콘텐츠(이하 “게시물”)의 저작권은 회원에게 있으며, 회사는 서비스 운영, 홍보 등을 위해 필요한 범위 내에서 이를 사용할 수 있습니다.<br>
                    ② 회원의 게시물이 법령 또는 본 약관에 위반되는 경우 회사는 사전 통보 없이 삭제할 수 있습니다.<br>
                    ③ 회원은 타인의 저작권 및 초상권을 침해하지 않도록 주의해야 합니다.<br><br>

                    11. 계약의 해지 및 이용제한<br>
                    ① 회원은 언제든지 서비스 내 탈퇴 기능을 이용하여 이용계약을 해지할 수 있습니다.<br>
                    ② 회사는 회원이 본 약관을 위반하거나 서비스 운영에 지장을 초래한 경우, 이용을 제한하거나 계약을 해지할 수 있습니다.<br><br>

                    12. 책임의 제한<br>
                    ① 회사는 천재지변, 통신장애 등 불가항력적인 사유로 인한 서비스 중단에 대하여 책임을 지지 않습니다.<br>
                    ② 회사는 회원 상호 간 또는 회원과 제3자 간 거래로 발생한 분쟁에 대하여 개입하지 않으며, 이로 인한 손해에 대해 책임을 지지 않습니다.<br><br>

                    13. 약관의 해석 및 준거법<br>
                    ① 본 약관에 명시되지 않은 사항은 관련 법령과 상관례에 따릅니다.<br>
                    ② 서비스 이용과 관련하여 회사와 회원 간 발생한 분쟁은 대한민국 법령을 기준으로 해결합니다.<br><br>

                    14. 동의 안내<br>
                    이 약관의 내용을 충분히 이해하신 후 동의하시는 경우에만 회원가입을 진행해 주시기 바랍니다.<br>
                    약관에 동의하지 않으실 경우 서비스 이용이 제한될 수 있습니다.
                </div>

                <label>
                    <input type="checkbox" class="agree-item" required>
                    [필수] 개인정보 처리방침 동의
                    <span class="view-link" onclick="toggleDetails('terms2')">자세히 보기</span>
                </label>
                <div id="terms2" class="details">
                    1. 개인정보 수집 항목<br>
                    이용자가 (서비스) 등 회사의 서비스(이하 '회사의 서비스')를 이용하기 위해 회원가입을 할 경우, 회사는 서비스 이용을 위해 아래와 같이 필요한 최소한의 개인정보를 수집합니다.<br>
                    ① 회사는 최초 회원가입 시 회원 식별 및 서비스 제공을 위해 아래와 같은 정보를 수집합니다.<br>
                      - 필수항목: 이메일, 아이디, 비밀번호, 휴대전화 번호, 집 주소, 이름<br>
                      - 선택항목: 가입경로<br>
                    ② 회사는 만 14세 미만 아동의 경우, 법정대리인으로부터 다음과 같은 정보를 수집할 수 있습니다.<br>
                      - 법정대리인(보호자)의 이름, 생년월일, 성별, 내/외국인 여부, 휴대전화 번호, 이동통신사 정보, 아이핀 정보(아이핀 확인 시)<br>
                    ③ 회사는 서비스 이용 과정에서 아래와 같은 정보들이 생성되는 경우 이를 수집할 수 있습니다.<br>
                      - PC/모바일 웹 서비스 이용 기록, 쿠키, 접속지 정보, 기기 정보, 불량 이용 기록, 방문 일시<br>
                    ④ 회사는 이용자가 서비스 이용 과정에서 입력하는 방식(예: ) 등을 통하여 생성되는 개인정보를 수집합니다.<br><br>

                    2. 개인정보 수집 및 이용 목적<br>
                    회사는 수집된 개인정보를 아래와 같은 이용 목적으로 활용합니다.<br>
                    ① 본인인증, 구매 및 요금 결제, 상품 및 서비스의 배송, 콘텐츠 제공 등 유료 서비스 제공을 위하여 활용됩니다.<br>
                    ② 회원 가입 의사의 확인, 연령 확인 및 법정대리인 동의 진행, 이용자 및 법정대리인의 본인 확인, 이용자 식별, 회원 탈퇴 의사의 확인 등 회원 관리를 위하여 개인정보를 이용합니다.<br>
                    ③ 콘텐츠 등 기존 서비스 제공에 더하여, 서비스 이용에 대한 통계, 서비스 방문 및 이용 기록과 접속 빈도 분석 등 신규 서비스 요소의 발굴 및 기존 서비스 개선 등을 위하여 개인정보를 이용합니다.<br>
                    ④ 법령 및 회사 이용약관을 위반하는 회원에 대한 이용 제한 조치, 부정 이용 행위를 포함하여 서비스의 원활한 운영에 지장을 주는 행위에 대한 방지 및 제재, 계정 도용 및 부정 거래 방지, 약관 개정 등의 고지사항 전달, 분쟁조정을 위한 기록 보존, 민원처리 등 이용자 보호 및 서비스 운영을 위해 활용됩니다.<br>
                    ⑤ 요청 이행 및 거래 처리, 고지사항 전달, 불만 처리 등 민원 처리 등 회원 관리를 위하여 활용됩니다.<br><br>

                    3. 개인정보의 보유 및 이용 기간<br>
                    회사는 이용자의 개인정보에 대해 개인정보의 수집·이용 목적이 달성을 위한 기간 동안 개인정보를 보유 및 이용합니다. 다만, 목적을 달성한 이후에도 관련 법령에서 정한 바가 있으면 그에 따라 개인정보를 보존, 활용하고 있습니다.<br><br>

                    회사는 관계 법령에 따라 다음과 같이 개인정보를 보유 및 이용합니다.<br><br>

                    ① 전자상거래 등에서의 소비자보호에 관한 법률에 따른 보유 정보 및 보유 기간<br>
                        - 계약 또는 청약 철회 등에 관한 기록: 5년<br>
                        - 대금결제 및 재화 등의 공급에 관한 기록: 5년<br>
                    ② 통신비밀보호법에 따른 보유 정보 및 보유 기간<br>
                        - 웹사이트 로그 기록 자료: 3개월<br>
                    ③ 전자금융거래법에 따른 보유 정보 및 보유 기간<br>
                        - 전자금융거래에 관한 기록: 5년<br>
                    ④ 위치정보의 보호 및 이용등에 관한 법률에 따른 보유 정보 및 보유 기간<br>
                        - 개인위치정보에 관한 기록: 6개월<br>
                    ⑤ 전자상거래 등에서의 소비자보호에 관한 법률 시행령<br>
                        - 소비자의 불만 또는 분쟁처리에 관한 기록: 3년<br>
                    ⑥ 개인정보처리방침에 따른 부정사용자의 이용 기록 및 중복가입 확인 정보 보유 기간<br>
                        - 회원 탈퇴 시점으로부터 최대 1년간 보관<br>
                    ⑦기타 관련 법령 준수를 위해 필요한 기록<br>
                        - 관련 법령에 준함<br><br>

                    4. 거부 시 불이익<br>
                    위 내용을 자세히 읽은 후 이에 동의하시는 경우에만 회원 가입을 진행해 주시기 바랍니다. 본 동의에 대해 거부하실 권리가 있으나 거부 시 회사가 제공하는 서비스 이용이 제한될 수 있습니다.

                </div>

                <label>
                    <input type="checkbox" class="agree-item">
                    [선택] 마케팅 및 광고성 정보 수신 동의
                    <span class="view-link" onclick="toggleDetails('terms3')">자세히 보기</span>
                </label>
                <div id="terms3" class="details">
                    1. 수집 목적<br>
                    회사는 수집된 개인정보를 아래와 같은 목적으로 활용합니다.<br>

                    ①서비스 및 제품소개를 위하여 이용됩니다.<br><br>

                    2. 수집 항목<br>
                    회사는 최초 회원가입 시 회원 식별 및 서비스 제공을 위해 아래와 같은 정보를 수집합니다.<br>

                    ①성명, 전화번호, 이메일<br><br>

                    3. 보유 기간<br>
                    회사는 이용자의 개인정보에 대해 개인정보의 수집·이용 목적이 달성을 위한 기간동안 개인정보를 보유 및 이용합니다. 개인정보 수집 및 이용목적이 달성된 후에는 해당 정보를 지체 없이 파기합니다.<br><br>

                    4. 거부 시 불이익<br>
                    정보주체는 위와 같이 개인정보를 처리하는 것에 대한 동의를 거부할 권리가 있습니다. 본 동의 거부 시 (서비스)이/가 제한될 수 있습니다.
                </div>
            </div>

            <button type="submit" class="btn-signup" id="signupBtn">회원가입하고 3,000P 받기</button>
        </form>

        <div class="login-link">
            이미 계정이 있으신가요? 
            <a href="login.html">로그인</a>
        </div>
    </div>

    <script>
        // Firebase Realtime Database URL (여기에 본인의 Firebase URL을 입력하세요)
        const FIREBASE_DB_URL = 'https://ulsan-restaurant-default-rtdb.firebaseio.com';

        // 전체 동의 체크박스
        document.getElementById('agreeAll').addEventListener('change', function() {
            const checkboxes = document.querySelectorAll('.agree-item');
            checkboxes.forEach(cb => cb.checked = this.checked);
        });

        // 약관 내용 펼치기
        function toggleDetails(id) {
            document.getElementById(id).classList.toggle('open');
        }

        // 전체 동의 기능
        const agreeAll = document.getElementById('agreeAll');
        const agreeItems = document.querySelectorAll('.agree-item');

        agreeAll.addEventListener('change', function() {
            agreeItems.forEach(cb => cb.checked = this.checked);
        });

        agreeItems.forEach(cb => {
            cb.addEventListener('change', function() {
                agreeAll.checked = Array.from(agreeItems).every(item => item.checked);
            });
        });

        // 비밀번호 강도 체크
        document.getElementById('userPw').addEventListener('input', function() {
            const password = this.value;
            const strengthBar = document.getElementById('pwStrengthBar');
            const strengthDiv = document.getElementById('pwStrength');
            
            if (password.length === 0) {
                strengthDiv.classList.remove('show');
                return;
            }
            
            strengthDiv.classList.add('show');
            strengthBar.className = 'password-strength-bar';
            
            if (password.length < 6) {
                strengthBar.classList.add('strength-weak');
            } else if (password.length < 10) {
                strengthBar.classList.add('strength-medium');
            } else {
                strengthBar.classList.add('strength-strong');
            }
        });

        // 비밀번호 확인 체크
        document.getElementById('userPwConfirm').addEventListener('input', function() {
            const password = document.getElementById('userPw').value;
            const confirmPassword = this.value;
            const errorMsg = document.getElementById('pwConfirmError');
            const successMsg = document.getElementById('pwConfirmSuccess');
            
            if (confirmPassword.length === 0) {
                errorMsg.classList.remove('show');
                successMsg.classList.remove('show');
                return;
            }
            
            if (password !== confirmPassword) {
                errorMsg.textContent = '비밀번호가 일치하지 않습니다.';
                errorMsg.classList.add('show');
                successMsg.classList.remove('show');
            } else {
                errorMsg.classList.remove('show');
                successMsg.classList.add('show');
            }
        });

        // 이메일 유효성 검사
        function validateEmail(email) {
            const re = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            return re.test(email);
        }

        // 고유 사용자 ID 생성 (이메일 기반)
        function generateUserId(email) {
            return email.replace(/[.@]/g, '_');
        }

        // 이메일 중복 체크
        async function checkEmailExists(userId) {
            try {
                const response = await fetch(`${FIREBASE_DB_URL}/users/${userId}.json`);
                if (!response.ok) {
                    throw new Error('HTTP ' + response.status);
                }
                const data = await response.json();
                return data !== null;
            } catch (error) {
                console.error('이메일 중복 체크 에러:', error);
                return false;
            }
        }

        // 회원가입 폼 제출
        document.getElementById('signupForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const name = document.getElementById('userName').value.trim();
            const email = document.getElementById('userEmail').value.trim();
            const password = document.getElementById('userPw').value;
            const passwordConfirm = document.getElementById('userPwConfirm').value;
            const signupBtn = document.getElementById('signupBtn');
            
            // 초기화
            document.querySelectorAll('.error-message').forEach(el => el.classList.remove('show'));
            
            // 유효성 검사
            if (name.length < 2) {
                document.getElementById('nameError').textContent = '이름은 2자 이상이어야 합니다.';
                document.getElementById('nameError').classList.add('show');
                return;
            }

            if (!validateEmail(email)) {
                document.getElementById('emailError').textContent = '올바른 이메일 형식이 아닙니다.';
                document.getElementById('emailError').classList.add('show');
                return;
            }
            
            if (password.length < 8) {
                document.getElementById('pwError').textContent = '비밀번호는 8자 이상이어야 합니다.';
                document.getElementById('pwError').classList.add('show');
                return;
            }
            
            if (password !== passwordConfirm) {
                document.getElementById('pwConfirmError').textContent = '비밀번호가 일치하지 않습니다.';
                document.getElementById('pwConfirmError').classList.add('show');
                return;
            }
            
            // 필수 약관 체크
            const requiredCheckboxes = document.querySelectorAll('.agree-item[required]');
            const allChecked = Array.from(requiredCheckboxes).every(cb => cb.checked);
            
            if (!allChecked) {
                alert('필수 약관에 동의해주세요.');
                return;
            }
            
            // 버튼 비활성화
            signupBtn.disabled = true;
            signupBtn.textContent = '가입 중...';
            
            try {
                // 고유 사용자 ID 생성
                const userId = generateUserId(email);
                
                // 이메일 중복 체크
                const emailExists = await checkEmailExists(userId);
                if (emailExists) {
                    document.getElementById('emailError').textContent = '이미 사용 중인 이메일입니다.';
                    document.getElementById('emailError').classList.add('show');
                    return;
                }
                
                // 사용자 데이터 구성
                const userData = {
                    name: name,
                    email: email,
                    password: password, // 실제 서비스에서는 암호화 필요!
                    points: 3000,
                    createdAt: new Date().toISOString(),
                    role: 'user'
                };
                
                // Firebase Realtime Database에 저장
                const response = await fetch(`${FIREBASE_DB_URL}/users/${userId}.json`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(userData)
                });
                
                if (!response.ok) {
                    throw new Error('HTTP ' + response.status);
                }
                
                alert(`회원가입 완료!\n환영합니다, ${name}님!\n3,000 포인트가 지급되었습니다.`);
                
                // 폼 초기화
                document.getElementById('signupForm').reset();
                document.getElementById('pwConfirmSuccess').classList.remove('show');
                document.getElementById('pwStrength').classList.remove('show');
                
                // 로그인 페이지로 이동 (필요시)
                // window.location.href = 'login.html';
                
            } catch (error) {
                console.error('회원가입 에러:', error);
                alert('회원가입에 실패했습니다. 다시 시도해주세요.');
            } finally {
                signupBtn.disabled = false;
                signupBtn.textContent = '회원가입하고 3,000P 받기';
            }
        });
    </script>
</body>
</html>